<view class="detail-container">
  <!-- 顶部信息卡片 -->
  <view class="target-card">
    <!-- 创建人信息 -->
    <view class="creator-info">
      <view class="creator-left">
        <view class="creator-main">
          <image class="creator-avatar" src="{{creator.avatar}}" mode="aspectFill"></image>
          <text class="creator-name">{{creator.name}}</text>
        </view>
        <text class="creator-label">发起了一个挑战</text>
      </view>
    </view>

    <view class="target-info">
      <view class="target-title">每日晨跑5公里</view>
      <view class="target-desc">21天养成习惯，改变从现在开始</view>
      <view class="target-stats">
        <view class="stat-item">
          <text class="num">21</text>
          <text class="label">总天数</text>
        </view>
        <view class="stat-item">
          <text class="num">{{currentDay}}</text>
          <text class="label">当前天数</text>
        </view>
        <view class="stat-item">
          <text class="num">¥100</text>
          <text class="label">瓜分金额</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 标签页 -->
  <view class="tabs">
    <view class="tab-item {{currentTab === 0 ? 'active' : ''}}"
      bindtap="switchTab"
      data-index="0">
      目标分解
    </view>
    <view class="tab-item {{currentTab === 1 ? 'active' : ''}}"
      bindtap="switchTab"
      data-index="1">
      激励师
    </view>
    <view class="tab-item {{currentTab === 2 ? 'active' : ''}}"
      bindtap="switchTab"
      data-index="2">
      打卡记录
    </view>
    <view class="tab-item {{currentTab === 3 ? 'active' : ''}}"
      bindtap="switchTab"
      data-index="3">
      激励记录
    </view>
  </view>

  <!-- 列表区域 -->
  <scroll-view class="list-container"
    scroll-y 
    refresher-enabled="{{false}}"
    refresher-triggered="{{refreshing}}"
    bindscrolltolower="onReachBottom">
    
  <!-- 任务列表 -->
    <view class="task-list" wx:if="{{currentTab === 0}}">
      <view class="task-item" wx:for="{{tasks}}" wx:key="id">
        <view class="task-content">
          <view class="task-main">
            <text class="task-title">#{{index + 1}} {{item.title}}</text>
            <view class="task-meta">
              <text class="checkin-count">已打卡 {{item.checkinCount}} 次</text>
              <text class="create-time">{{item.decomposeTime}}创建</text>
            </view>
          </view>
        </view>
        <view class="task-status {{item.checked ? 'checked' : 'unchecked'}}">
          {{item.checked ? '已打卡' : '未打卡'}}
        </view>
      </view>
    </view>
    <!-- 激励师列表 -->
    <view class="mentor-list" wx:if="{{currentTab === 1}}">
      <view class="mentor-item" wx:for="{{mentors}}" wx:key="id">
        <view class="mentor-info">
          <image class="mentor-avatar" src="{{item.avatar}}" mode="aspectFill"></image>
          <view class="mentor-details">
            <view class="mentor-header">
              <text class="mentor-name">{{item.name}}</text>
              <text class="mentor-title">{{item.title}}</text>
            </view>
            <view class="mentor-stats">
              <text class="remind-count">提醒: {{item.remindCount}}次</text>
              <text class="join-time">{{item.joinTime}}加入</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <!-- 打卡记录列表 -->
    <view class="record-list" wx:if="{{currentTab === 2}}">
      <view class="record-item" wx:for="{{checkInList}}" wx:key="id">
        <view class="record-header">
          <image class="user-avatar" src="{{item.avatar}}" mode="aspectFill"></image>
          <text class="user-name">{{item.username}}</text>
         
        </view>
        <view class="record-content">{{item.content}}</view>
        <view class="record-images" wx:if="{{item.images.length > 0}}">
          <image 
            wx:for="{{item.images}}" 
            wx:for-item="image" 
            wx:key="*this" 
            src="{{image}}" 
            mode="aspectFill"
            bindtap="previewImage"
            data-urls="{{item.images}}"
            data-current="{{image}}"
          ></image>
        </view>
        <text class="record-time">{{item.time}}</text>
      </view>
    </view>

    <!-- 激励记录列表 -->
    <view class="motivation-list" wx:if="{{currentTab === 3}}">
      <view class="motivation-item" wx:for="{{motivations}}" wx:key="id">
        <view class="motivation-header">
          <image class="mentor-avatar" src="{{item.mentorAvatar}}" mode="aspectFill"></image>
          <text class="mentor-name">{{item.mentorName}}</text>
        </view>
        <view class="motivation-content">{{item.content}}</view>
        <view class="motivation-images" wx:if="{{item.images.length > 0}}">
          <image 
            wx:for="{{item.images}}" 
            wx:for-item="image" 
            wx:key="*this" 
            src="{{image}}" 
            mode="aspectFill"
            bindtap="previewImage"
            data-urls="{{item.images}}"
            data-current="{{image}}"
          ></image>
        </view>
        <text class="motivation-time">{{item.time}}</text>
      </view>
    </view>

    <!-- 加载更多 -->
    <view wx:if="{{hasMore}}" class="loading-more">
      <text>加载中...</text>
    </view>
    <view wx:else class="no-more">
      <text>没有更多数据了</text>
    </view>
  </scroll-view>
  
  <!-- 打卡按钮/状态 -->
  <!-- <view class="checkin-section">
    <block wx:if="{{!hasJoined}}">
      <button class="join-btn" bindtap="handleJoin">立即参与</button>
    </block>
    <block wx:else>
      <button class="checkin-btn {{todayChecked ? 'checked' : ''}}" bindtap="handleCheckin">
        {{todayChecked ? '今日已打卡' : '立即打卡'}}
      </button>
    </block>
  </view> -->
</view>